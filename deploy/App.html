<!DOCTYPE html>
<html>
<head>
    <title>LEAD-STEER-EXECUTE Metrics</title>

    <script type="text/javascript" src="/apps/2.0/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){var PROJECT_RADIAN="37192747640",PROJECT_BUSINESS="37637012809",PROJECT_SPRINT_TEAMS="37213611687",PROJECT_SUPPORTING_TEAMS="37192947515",PROJECT_EXECUTION="37192748545",PROJECT_AWS_TEAMS="35625370074",PROJECT_ECMLDR_TEAMS="35625373948",PROJECT_PAS_TEAMS="34799452294",PROJECT_SFDC_TEAMS="35625125755",context=this.getContext();this._addAvg(this,"Iteration",this._filterLastSixWeeksOfIterations(),PROJECT_ECMLDR_TEAMS,"Average Velocity","PlannedVelocity")},_addLine:function(container,value){container.add({xtype:"component",html:value})},_dumpTimeContext:function(container,context){var timeboxScope=context.getTimeboxScope(),type=timeboxScope&&timeboxScope.getType(),record=timeboxScope&&timeboxScope.getRecord();timeboxScope?this._addLine(container,"Timebox scope: "+type+", value: "+(record?record.get("Name"):"Unscheduled")):this._addLine("No timebox scope")},_addStoryGrid:function(container,context){container.add({xtype:"rallygrid",itemId:"storyGrid",columnCfgs:["FormattedID","Name","Project"],context:context,storeConfig:{model:"userstory",filters:[{property:"LastUpdateDate",operator:">=",value:"today-7"}],context:{project:context.getProject(),projectScopeDown:!0}}})},_filterByID:function(initiative){return{property:"FormattedID",operator:"=",value:initiative}},_filterByState:function(value){var filters=Ext.create("Rally.data.QueryFilter",{property:"State.Name",operator:"=",value:value});return filters},_filterEstimatedStoriesByRelease:function(value){var filters=Ext.create("Rally.data.QueryFilter",{property:"Release.Name",operator:"=",value:value});return filters=filters.and(Ext.create("Rally.data.QueryFilter",{property:"PlanEstimate",operator:">",value:"0"}))},_filterLastSixWeeksOfIterations:function(){var filters=Ext.create("Rally.data.QueryFilter",{property:"StartDate",operator:"=",value:"today - 56"});return filters=filters.and(Ext.create("Rally.data.QueryFilter",{property:"EndDate",operator:"<",value:"today"}))},_addAvg:function(container,model,filters,project,message,field){Ext.create("Rally.data.wsapi.Store",{model:model,pagesize:1,autoLoad:!0,columnCfgs:["Name","Project","PlannedVelocity","PlanEstimate"],context:{project:"/project/"+project},filters:filters,listeners:{load:function(store,records){var total=0;container._addLine(container,store.getTotalCount()+" "+model+" rows in "+filters),container._addLine(container,"first field:"+records[0].get("Name")),Ext.Array.each(records,function(row){total+=row.PlanEstimate||0,container._addLine(container,"found row "+row.get("Name")+" "+row.get("Project")+" "+row.get("PlannedVelocity")+" "+row.get("PlanEstimate"))}),container._addLine(container,message+" "+total)}}})},_addCount:function(container,model,filters,project,message){Ext.create("Rally.data.wsapi.Store",{model:model,pagesize:1,autoLoad:!0,context:{project:"/project/"+project,projectScopeDown:!0,projectScopeUp:!1},filters:filters,listeners:{load:function(store,records){container._addLine(container,message+" "+store.getTotalCount())}}})},_addFeatureGrid:function(container,ID,filters,project,hideHeaders){this._addPortfolioGrid(container,ID,filters,project,hideHeaders,["FormattedID","Name","State","c_BusinessPreWorkState","c_FeatureQACoordinator","c_UATState","Project"],"Feature",!0)},_addThemeGrid:function(container,ID,filters,project,hideHeaders){this._addPortfolioGrid(container,ID,filters,project,hideHeaders,["FormattedID","Name","PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","AcceptedLeafStoryCount","LeafStoryCount","State","c_BusinessPreWorkState","c_FeatureQACoordinator","c_UATState","Project"],"Theme",!1)},_addInitiativeGrid:function(container,ID,filters,project,hideHeaders){this._addPortfolioGrid(container,ID,filters,project,hideHeaders,["FormattedID","Name","PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","AcceptedLeafStoryCount","LeafStoryCount","PlannedEndDate","PreliminaryEstimate","RefinedEstimate","UnEstimatedLeafStoryCount"],"Initiative",!1)},_addPortfolioGrid:function(container,ID,filters,project,hideHeaders,columns,model,paging){container.add({xtype:"rallygrid",itemId:"portfolioGrid"+ID,showPagingToolbar:paging,hideHeaders:hideHeaders,viewConfig:{shrinkWrap:3},columnCfgs:columns,storeConfig:{model:"PortfolioItem/"+model,autoload:!0,context:{project:"/project/"+project,projectScopeDown:!0,projectScopeUp:!1},filters:filters}})},_isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)}});

            Rally.launchApp('CustomApp', {
                name:"LEAD-STEER-EXECUTE Metrics",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
